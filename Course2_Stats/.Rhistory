View(gss)
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital==1 & (wrkstat == 1 | wrkstat == 2) & (spwrksta == 1 | spwrksta == 2)), coninc / 2, coninc)) %>%
select(coninc, class, per_income) %>%
mutate(diff = coninc - per_income) %>%
summarise(total_error = sum(diff * diff))
gss %>%
filter(marital=='Married')
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital==1 & (wrkstat == 1 | wrkstat == 2) & (spwrksta == 1 | spwrksta == 2)), coninc / 2, coninc)) %>%
select(coninc, class, per_income) %>%
mutate(diff = coninc - per_income) %>%
summarise(total_error = sum(diff * diff))
gss %>%
filter(marital=='Married', (wrkstat == 'WORKING FULLTIME' | wrkstat == 'WORKING PARTTIME'), (spwrksta == 'WORKING FULLTIME' | spwrksta == 'WORKING PARTTIME'))
View(gss)
View(gss)
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital==1 & (wrkstat == 1 | wrkstat == 2) & (spwrksta == 1 | spwrksta == 2)), coninc / 2, coninc)) %>%
select(coninc, class, per_income) %>%
mutate(diff = coninc - per_income) %>%
summarise(total_error = sum(diff * diff))
gss %>%
filter(marital=='Married', (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime'), (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime'))
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital=='Married' & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(coninc, class, per_income) %>%
mutate(diff = coninc - per_income) %>%
summarise(total_error = sum(diff * diff))
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital=='Married' & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(coninc, class, per_income)
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital=='Married' & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(coninc, class, per_income) %>%
mutate(diff = coninc - per_income)
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital=='Married' & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
group_by(class) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75), n = n())
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital=='Married' & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(coninc, class, per_income) %>%
filter(is.na(per_income))
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital=='Married' & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(class, marital, wrkstat, spwrksta, coninc, per_income) %>%
filter(is.na(per_income))
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(class, marital, wrkstat, spwrksta, coninc, per_income) %>%
filter(is.na(per_income))
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(getahead, per_income)
gss_2012 %>%
str()
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(class)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
group_by(class) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75), n = n())
gss %>%
filter(year == 2012, !is.na(coninc), !is.na(rank)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
group_by(rank) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75), n = n())
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75), n = n())
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.33), q3 = quantile(per_income, 0.66), n = n())
gss %>%
filter(year == 2012, !is.na(class)) %>%
group_by(class) %>%
summarise(count = n(), prop = n / sum(n))
gss %>%
filter(year == 2012, !is.na(class)) %>%
group_by(class) %>%
summarise(count = n(), prop = n() / sum(n()))
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.33), q3 = quantile(per_income, 0.66), n = n())
gss %>%
filter(year == 2012, !is.na(class)) %>%
group_by(class) %>%
summarise(count = n(), prop = n() / sum(count))
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.33), q3 = quantile(per_income, 0.66), n = n())
gss %>%
filter(year == 2012, !is.na(class)) %>%
group_by(class) %>%
summarise(count = n()) %>%
mutate(prop = count / sum(count))
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.33), q3 = quantile(per_income, 0.66), n = n())
gss %>%
filter(year == 2012, !is.na(class)) %>%
group_by(class) %>%
summarise(count = n()) %>%
mutate(prop = count / sum(count))
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.54), q3 = quantile(per_income, 0.97), n = n())
gss %>%
filter(year == 2012, !is.na(class)) %>%
group_by(class) %>%
summarise(count = n()) %>%
mutate(prop = count / sum(count))
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.50), q3 = quantile(per_income, 0.90), n = n())
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.55), q3 = quantile(per_income, 0.90), n = n())
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.60), q3 = quantile(per_income, 0.90), n = n())
gss %>%
filter(year == 2012, !is.na(class)) %>%
group_by(class) %>%
summarise(count = n()) %>%
mutate(prop = count / sum(count))
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.50), q3 = quantile(per_income, 0.90), n = n())
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75), n = n())
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.2), q3 = quantile(per_income, 0.8), n = n())
gss %>%
filter(year == 2012, !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), q1 = quantile(per_income, 0.2), q3 = quantile(per_income, 0.8), n = n())
gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), q1 = quantile(per_income, 0.2), q3 = quantile(per_income, 0.8), n = n())
gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), q1 = quantile(per_income, 0.3), q3 = quantile(per_income, 0.9), n = n())
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
select(getahead, per_income)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
select(getahead, coninc)
gss_2012 %>%
str()
gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
select(coninc) %>%
summarise(min = min(coninc), max = max(coninc), mean = mean(coninc), median = median(coninc), q1 = quantile(coninc, 0.3), q3 = quantile(coninc, 0.9), n = n())
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>%
select(per_income) %>%
summarise(min = min(per_income), max = max(per_income), mean = mean(per_income), median = median(per_income), q1 = quantile(per_income, 0.3), q3 = quantile(per_income, 0.9), n = n())
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram()
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 5000)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram()
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 5000)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 15000)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(per_income))
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(data=gss_2012, xintercept = median(per_income))
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income))
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = blue) +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))))
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))))
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))), vjust = 1.5)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))), vjust = 10000)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))), vjust = 10)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))), hjust = 10)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))), hjust = 1)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))), hjust = -1)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))), hjust = -0.5)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))), hjust = -0.25)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))), hjust = -0.2)
gss_2012 <- gss %>%
filter(year == 2012, !is.na(getahead), !is.na(coninc)) %>%
mutate(per_income = ifelse((marital=='Married' & !is.na(wrkstat) & !is.na(spwrksta) & (wrkstat == 'Working Fulltime' | wrkstat == 'Working Parttime') & (spwrksta == 'Working Fulltime' | spwrksta == 'Working Parttime')), coninc / 2, coninc)) %>% # This line is to check if the income is coming from both husband and wife. If so, divide by 2 to get income per person.
select(getahead, per_income)
gss_2012 %>%
str()
ggplot(data=gss_2012, aes(x=per_income)) +
geom_histogram(binwidth = 10000) +
geom_vline(xintercept = median(gss_2012$per_income), colour = "blue") +
geom_text(aes(x=median(gss_2012$per_income), y=210, label=paste("Median: ",median(gss_2012$per_income))), hjust = -0.2, colour = "blue")
gss_2012_fac <- gss_2012 %>%
mutate(income_level = ifelse(per_income <= 17235, "low", ifelse(per_income >= 89356, "high", "medium")))
gss_2012_fac
gss_2012_fac <- gss_2012 %>%
mutate(income_level = ifelse(per_income <= 17235, "low", ifelse(per_income >= 89356, "high", "medium")))
gss_2012_fac <- gss_2012 %>%
mutate(income_level = ifelse(per_income <= 17235, "low", ifelse(per_income >= 89356, "high", "medium")))
head(gss_2012_fac, n=5)
gss_2012_stat <- gss_2012_fac %>%
group_by(getahead) %>%
summarise(mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75))
View(gss_2012_stat)
View(gss_2012_stat)
gss_2012_stat <- gss_2012_fac %>%
group_by(getahead) %>%
summarise(mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75)) %>%
order_by(median)
gss_2012_fac %>%
group_by(getahead) %>%
summarise(mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75)) %>%
order_by(median)
gss_2012_fac %>%
group_by(getahead) %>%
summarise(mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75)) %>%
order_by(median)
gss_2012_fac %>%
group_by(getahead) %>%
summarise(mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75))
gss_2012_fac %>%
group_by(getahead) %>%
summarise(mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75))
ggplot(data=gss_2012_fac, aes(x=factor(getahead), y=per_income)) +
geom_boxplot()
gss_2012_fac %>%
group_by(getahead, income_level) %>%
summarise(count = n, proportion, n / count)
gss_2012_fac %>%
group_by(getahead, income_level) %>%
summarise(count = n, proportion, n / sum(n))
gss_2012_fac %>%
group_by(getahead, income_level) %>%
summarise(count = n(), proportion, n() / sum(n()))
gss_2012_fac %>%
group_by(getahead, income_level) %>%
summarise(count = n(), proportion = n() / sum(n()))
gss_2012_fac %>%
group_by(getahead, income_level) %>%
summarise(count = n()) %>%
mutate(proportion = n() / sum(n()))
gss_2012_fac %>%
group_by(getahead, income_level) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
gss_2012_prop <- gss_2012_fac %>%
group_by(getahead, income_level) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
gss_2012_prop <- gss_2012_fac %>%
group_by(getahead, income_level) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
gss_2012_prop
ggplot(data=gss_2012_prop, aes(x=factor(getahead), y=proportion, fill=income_level)) +
geom_bar()
gss_2012_prop <- gss_2012_fac %>%
group_by(getahead, income_level) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
gss_2012_prop
ggplot(data=gss_2012_prop, aes(x=factor(getahead), y=proportion, fill=income_level)) +
geom_bar(position = "fill",stat = "identity")
gss_2012_fac %>%
group_by(getahead) %>%
summarise(mean = mean(per_income), median = median(per_income), iqr = IQR(per_income), q1 = quantile(per_income, 0.25), q3 = quantile(per_income, 0.75))
ggplot(data=gss_2012_fac, aes(x=getahead, y=per_income)) +
geom_boxplot()
gss_2012_prop <- gss_2012_fac %>%
group_by(getahead, income_level) %>%
summarise(count = n()) %>%
mutate(proportion = count / sum(count))
gss_2012_prop
ggplot(data=gss_2012_prop, aes(x=getahead, y=proportion, fill=income_level)) +
geom_bar(position = "fill",stat = "identity")
data_table <- table(gss_2012_fac$getahead, gss_2012_fac$income_level)
data_table
data_table <- table(gss_2012_fac$getahead[gss_2012_fac$getahead != 'Other'], gss_2012_fac$income_level)
data_table
data_table <- table(gss_2012_fac$getahead, gss_2012_fac$income_level)[,-1]
data_table
data_table <- table(gss_2012_fac$getahead, gss_2012_fac$income_level)[-1,]
data_table
data_table <- table(gss_2012_fac$getahead, gss_2012_fac$income_level)[:-1,]
data_table <- table(gss_2012_fac$getahead, gss_2012_fac$income_level)[4,]
data_table
data_table <- table(gss_2012_fac$getahead, gss_2012_fac$income_level)[1,]
data_table
data_table <- table(gss_2012_fac$getahead, gss_2012_fac$income_level)[1:3,]
data_table
data_table <- table(gss_2012_fac$income_level, gss_2012_fac$getahead)[,1:3]
data_table
chisq.test(data_table)
