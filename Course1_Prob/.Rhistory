mutate(smok_intensity = smokday2 + "") %>%
transmute(smok_intensity = plyr::mapvalues(smok_intensity, c("Not at all", "Some days", "Every day"), c(0, 1, 2))) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
group_by(smokday2) %>%
mutate(smok_intensity = smokday2 + "") %>%
transmute(smok_intensity = plyr::mapvalues(smok_intensity, c("Not at all", "Some days", "Every day"), c(0, 1, 2)))
mental_smoke_summarise
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
group_by(smokday2) %>%
mutate(smok_intensity = smokday2 + "") %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
group_by(smokday2) %>%
mutate(smok_intensity = smokday2 + "") %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
group_by(smokday2) %>%
mutate(smok_intensity = smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = smokday2) %>%
group_by(smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = smokday2) %>%
group_by(smok_intensity, smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = smokday2) %>%
transmute(smok_intensity = plyr::mapvalues(smok_intensity, c("Not at all", "Some days", "Every day"), c(0, 1, 2))) %>%
group_by(smok_intensity, smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = plyr::mapvalues(smok_intensity, c("Not at all", "Some days", "Every day"), c(0, 1, 2))) %>%
group_by(smok_intensity, smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = plyr::mapvalues(smok_intensity, c("Not at all", "Some days", "Every day"), c(0, 1, 2))) %>%
mental_smoke_summarise
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = plyr::mapvalues(smokday2, c("Not at all", "Some days", "Every day"), c(0, 1, 2))) %>%
group_by(smok_intensity, smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise
ggplot(data=mental_smoke_summarise, aes(x=smok_intensity, y=avg_bad_mental_day)) +
geom_line() +
geom_dotplot()
ggplot(data=mental_smoke_summarise, aes(x=smok_intensity, y=avg_bad_mental_day)) +
geom_line() +
geom_dots()
ggplot(data=mental_smoke_summarise, aes(x=smok_intensity, y=avg_bad_mental_day)) +
geom_line() +
geom_point()
ggplot(data=mental_smoke_summarise, aes(x=smok_intensity, y=avg_bad_mental_day)) +
geom_point() +
geom_line()
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = plyr::mapvalues(smokday2, c("Not at all", "Some days", "Every day"), c(0, 1, 2))) %>%
group_by(smok_intensity, smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth)) %>%
arrange(smok_intensity)
mental_smoke_summarise
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = plyr::mapvalues(smokday2, c("Not at all", "Some days", "Every day"), c(0, 1, 2))) %>%
group_by(smok_intensity, smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise <- mental_smoke_summarise %>%
arrange(smok_intensity)
ggplot(data=mental_smoke_summarise, aes(x=smok_intensity, y=avg_bad_mental_day)) +
geom_point() +
geom_line()
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = plyr::mapvalues(smokday2, c("Not at all", "Some days", "Every day"), c(0, 1, 2))) %>%
group_by(smok_intensity, smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise <- mental_smoke_summarise %>%
arrange(smok_intensity)
mental_smoke_summarise %>%
str()
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = plyr::mapvalues(smokday2, c("Not at all", "Some days", "Every day"), c(0, 1, 2))) %>%
group_by(smok_intensity, smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise <- mental_smoke_summarise %>%
arrange(as.numeric(as.character(smok_intensity)))
mental_smoke_summarise
ggplot(data=mental_smoke_summarise, aes(x=smok_intensity, y=avg_bad_mental_day)) +
geom_point() +
geom_line()
ggplot(data=mental_smoke_summarise, aes(x=as.numeric(as.character(smok_intensity)), y=avg_bad_mental_day)) +
geom_point() +
geom_line()
mental_smoke_summarise <- mental_smoke_drink %>%
select(smokday2, menthlth) %>%
filter(!is.na(menthlth), !is.na(smokday2)) %>%
mutate(smok_intensity = plyr::mapvalues(smokday2, c("Not at all", "Some days", "Every day"), c(0, 1, 2))) %>%
group_by(smok_intensity, smokday2) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_smoke_summarise
ggplot(data=mental_smoke_summarise, aes(x=as.numeric(as.character(smok_intensity)), y=avg_bad_mental_day)) +
geom_point() +
geom_line()
mental_drink_summarise <- mental_smoke_drink %>%
select(avedrnk2, menthlth)
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(avedrnk2, menthlth) %>%
group_by(avedrnk2) %>%
summarise(avg_bad_mental_day = mean(menthlth))
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(avedrnk2, menthlth) %>%
filter(!is.na(menthlth)) %>%
group_by(avedrnk2) %>%
summarise(avg_bad_mental_day = mean(menthlth))
mental_drink_summarise
mental_smoke_drink <- brfss2013 %>%
select(menthlth, alcday5, avedrnk2, smokday2)
mental_smoke_drink %>%
str()
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5), !is.na(avedrnk2)) %>%
group_by(alcday5, avedrnk2) %>%
summarise(avg_bad_mental_day = mean(menthlth))
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5), !is.na(avedrnk2)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30)) %>%
mutate(drinks_30 = drink_freq * 30 * avedrnk2) %>%
group_by(drinks_30, drink_freq, avedrnk2) %>%
summarise(avg_bad_mental_day = mean(menthlth))
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5), !is.na(avedrnk2)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30)) %>%
mutate(drinks_monthly = drink_freq * 30 * avedrnk2) %>%
group_by(drinks_monthly, drink_freq, avedrnk2) %>%
summarise(avg_bad_mental_day = mean(menthlth))
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5), !is.na(avedrnk2)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30)) %>%
mutate(drinks_monthly = drink_freq * 30 * avedrnk2) %>%
group_by(drinks_monthly) %>%
summarise(avg_bad_mental_day = mean(menthlth))
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5), !is.na(avedrnk2)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30)) %>%
mutate(drinks_monthly = ceiling(drink_freq * 30 * avedrnk2)) %>%
group_by(drinks_monthly) %>%
summarise(avg_bad_mental_day = mean(menthlth))
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5), !is.na(avedrnk2)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30)) %>%
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5), !is.na(avedrnk2)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30))
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5), !is.na(avedrnk2)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30)) %>%
arrange(alcday5)
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30)) %>%
arrange(alcday5)
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30)) %>%
mutate(drinks_monthly = ceiling(drink_freq * 30 * avedrnk2)) %>%
group_by(drinks_monthly) %>%
summarise(avg_bad_mental_day = mean(menthlth))
mental_drink_summarise
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30)) %>%
mutate(drinks_monthly = ceiling(drink_freq * 30 * ifelse(is.na(avedrnk2), 0, avedrnk2))) %>%
group_by(drinks_monthly) %>%
summarise(avg_bad_mental_day = mean(menthlth))
mental_drink_summarise
ggplot(data=mental_drink_summarise, aes(x=drinks_monthly, y=avg_bad_mental_day)) +
geom_point() +
geom_line()
mental_drink_summarise <- mental_smoke_drink %>%
select(alcday5, avedrnk2, menthlth) %>%
filter(!is.na(menthlth), !is.na(alcday5)) %>%
mutate(drink_freq = ifelse(alcday5 < 200, (alcday5 %% 10) / 7, (alcday5 %% 100) / 30)) %>%
mutate(drinks_monthly = ceiling(drink_freq * 30 * ifelse(is.na(avedrnk2), 0, avedrnk2))) %>%
group_by(drinks_monthly) %>%
summarise(num_response = n(), avg_bad_mental_day = mean(menthlth))
mental_drink_summarise
mental_drink_summarise <- mental_drink_summarise %>%
filter(num_response >= 100)
mental_drink_summarise
ggplot(data=mental_drink_summarise, aes(x=drinks_monthly, y=avg_bad_mental_day)) +
geom_point() +
geom_line()
names(brfss2013)
income_age_edu <- brfss2013 %>%
select(X_incomg, ageg, X_educag)
grep("age", names(brfss2013), value = TRUE)
income_age_edu <- brfss2013 %>%
select(X_incomg, X_age_g, X_educag)
income_age_edu
income_age_edu <- brfss2013 %>%
select(X_incomg, X_age_g, X_educag, employ1)
income_age_edu
income_age_edu <- brfss2013 %>%
select(X_incomg, X_age_g, X_educag) %>%
filter(!is.na(X_incomg))
income_age_edu
income_age_edu <- brfss2013 %>%
select(income2, X_age_g, X_educag) %>%
filter(!is.na(X_incomg))
income_age_edu <- brfss2013 %>%
select(income2, X_age_g, X_educag) %>%
filter(!is.na(income2))
income_age_edu
income_age_edu <- brfss2013 %>%
select(income2, X_age_g, X_educag) %>%
filter(!is.na(income2)) %>%
group_by(income2, X_age_g, X_educag) %>%
summarise(count = n())
income_age_edu
income_age_edu <- brfss2013 %>%
select(income2, X_age_g, X_educag) %>%
filter(!is.na(income2), !is.na(X_age_g), !is.na(X_educag)) %>%
group_by(income2, X_age_g, X_educag) %>%
summarise(count = n())
income_age_edu
ggplot(data=income_age_edu, aes(x=factor(X_educag), y=factor(income2))) +
geom_point()
ggplot(data=income_age_edu, aes(x=factor(X_educag), y=factor(income2), z=count) +
geom_point()
fromVals <- c("Less than $10,000", "Less than $15,000", "Less than $20,000", "Less than $25,000", "Less than $35,000", "Less than $50,000", "Less than $75,000", "$75,000 or more")
toVals <- c(5000, 17500, 30000, 42500, 62500, 87500)
income_age_edu_disc <- income_age_edu %>%
mutate(income_disc = plyr::mapvalues(income2, fromVals, toVals))
fromVals <- c("Less than $10,000", "Less than $15,000", "Less than $20,000", "Less than $25,000", "Less than $35,000", "Less than $50,000", "Less than $75,000", "$75,000 or more")
toVals <- c(5000, 12500, 17500, 22500, 30000, 42500, 62500, 87500)
income_age_edu_disc <- income_age_edu %>%
mutate(income_disc = plyr::mapvalues(income2, fromVals, toVals))
income_age_edu_disc
fromVals <- c("Less than $10,000", "Less than $15,000", "Less than $20,000", "Less than $25,000", "Less than $35,000", "Less than $50,000", "Less than $75,000", "$75,000 or more")
toVals <- c(5000, 12500, 17500, 22500, 30000, 42500, 62500, 87500)
income_age_edu_disc <- income_age_edu %>%
mutate(income_disc = plyr::mapvalues(income2, fromVals, toVals)) %>%
select(X_age_g, X_educag, income_disc)
income_age_edu_disc
fromVals <- c("Less than $10,000", "Less than $15,000", "Less than $20,000", "Less than $25,000", "Less than $35,000", "Less than $50,000", "Less than $75,000", "$75,000 or more")
toVals <- c(5000, 12500, 17500, 22500, 30000, 42500, 62500, 87500)
income_age_edu_disc <- income_age_edu %>%
mutate(income_disc = plyr::mapvalues(income2, fromVals, toVals))
income_age_edu_disc
age_edu_avgincome <- income_age_edu_disc %>%
group_by(X_age_g, X_educag) %>%
summarise(avg_income = income_disc * count / sum(count))
age_edu_avgincome <- income_age_edu_disc %>%
group_by(X_age_g, X_educag) %>%
summarise(countval = sum(count), avg_income = income_disc * count / countval)
age_edu_avgincome <- income_age_edu_disc %>%
group_by(X_age_g, X_educag) %>%
summarise(countval = sum(count))
age_edu_avgincome
age_edu_avgincome <- income_age_edu_disc %>%
group_by(X_age_g, X_educag) %>%
summarise(countval = sum(count), total_income = income_disc * count)
age_edu_avgincome <- income_age_edu_disc %>%
group_by(X_age_g, X_educag) %>%
summarise(countval = sum(count), total_income = sum(income_disc * count) / countval)
age_edu_avgincome
age_edu_avgincome <- income_age_edu_disc %>%
mutate(total_income = income_disc * count)
group_by(X_age_g, X_educag) %>%
summarise(countval = sum(count), total_income = sum(total_income) / countval)
age_edu_avgincome <- income_age_edu_disc %>%
mutate(total_income = income_disc * count) %>%
group_by(X_age_g, X_educag) %>%
summarise(countval = sum(count), total_income = sum(total_income) / countval)
age_edu_avgincome
age_edu_avgincome <- income_age_edu_disc %>%
mutate(total_income = income_disc * count) %>%
group_by(X_age_g, X_educag) %>%
summarise(countval = sum(count), total_income = sum(total_income))
age_edu_avgincome
age_edu_avgincome <- income_age_edu_disc %>%
mutate(total_income = income_disc * count)
age_edu_avgincome
age_edu_avgincome <- income_age_edu_disc %>%
mutate(total_income = as.numeric(as.character(income_disc)) * count) %>%
group_by(X_age_g, X_educag) %>%
summarise(countval = sum(count), total_income = sum(total_income))
age_edu_avgincome
age_edu_avgincome <- income_age_edu_disc %>%
mutate(total_income = as.numeric(as.character(income_disc)) * count) %>%
group_by(X_age_g, X_educag) %>%
summarise(avg_income = sum(total_income) / sum(count))
age_edu_avgincome
ggplot(data=age_edu_avgincome, aes(x=X_age_g, y=avg_income, group=factor(X_educag))) +
geom_line()
ggplot(data=age_edu_avgincome, aes(x=X_age_g, y=avg_income, group=factor(X_educag), colour=X_educag)) +
geom_line()
ggplot(data=age_edu_avgincome, aes(x=X_age_g, y=avg_income, group=factor(X_educag), colour=X_educag)) +
geom_line() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
children_mental_income <- brfss2013 %>%
select(children, menthlth, income2)
children_mental_income %>%
str()
avg_bad_mental <- children_mental_income %>%
group_by(children, income2) %>%
summarise(num_resp = n(), avg_bad_day = mean(menthlth))
avg_bad_mental
avg_bad_mental <- children_mental_income %>%
filter(!is.na(children), !is.na(income2), !is.na(menthlth))
group_by(children, income2) %>%
summarise(num_resp = n(), avg_bad_day = mean(menthlth))
avg_bad_mental <- children_mental_income %>%
filter(!is.na(children), !is.na(income2), !is.na(menthlth)) %>%
group_by(children, income2) %>%
summarise(num_resp = n(), avg_bad_day = mean(menthlth))
avg_bad_mental
ggplot(data=avg_bad_mental, aes(x=children, y=avg_bad_day, group=factor(income2), colour=income2)) +
geom_line()
avg_bad_mental <- children_mental_income %>%
filter(!is.na(children), !is.na(income2), !is.na(menthlth)) %>%
group_by(children, income2) %>%
summarise(num_resp = n(), avg_bad_day = mean(menthlth))
avg_bad_mental <- avg_bad_mental %>%
filter(num_resp > 50)
avg_bad_mental
avg_bad_mental <- children_mental_income %>%
filter(!is.na(children), !is.na(income2), !is.na(menthlth)) %>%
group_by(children, income2) %>%
summarise(num_resp = n(), avg_bad_day = mean(menthlth))
avg_bad_mental <- avg_bad_mental %>%
filter(children < 7)
avg_bad_mental
ggplot(data=avg_bad_mental, aes(x=children, y=avg_bad_day, group=factor(income2), colour=income2)) +
geom_line()
avg_bad_mental <- children_mental_income %>%
filter(!is.na(children), !is.na(income2), !is.na(menthlth)) %>%
group_by(children, income2) %>%
summarise(num_resp = n(), avg_bad_day = mean(menthlth))
avg_bad_mental <- avg_bad_mental %>%
filter(children < 8)
avg_bad_mental
ggplot(data=avg_bad_mental, aes(x=children, y=avg_bad_day, group=factor(income2), colour=income2)) +
geom_line()
avg_bad_mental %>%
mutate(is_more = ifelse(children >= 7, "More than or equal", "Less than")) %>%
group_by(is_more) %>%
summarise(n = n()) %>%
mutate(prob = n / sum(n))
avg_bad_mental %>%
mutate(is_more = ifelse(children >= 7, "More than or equal", "Less than")) %>%
group_by(is_more) %>%
summarise(n = sum(num_resp)) %>%
mutate(prob = n / sum(n))
avg_bad_mental %>%
mutate(is_more = ifelse(children >= 6, "More than or equal", "Less than")) %>%
group_by(is_more) %>%
summarise(n = sum(num_resp)) %>%
mutate(prob = n / sum(n))
avg_bad_mental %>%
mutate(is_more = ifelse(children >= 5, "More than or equal", "Less than")) %>%
group_by(is_more) %>%
summarise(n = sum(num_resp)) %>%
mutate(prob = n / sum(n))
avg_bad_mental %>%
mutate(is_more = ifelse(children >= 4, "More than or equal", "Less than")) %>%
group_by(is_more) %>%
summarise(n = sum(num_resp)) %>%
mutate(prob = n / sum(n))
avg_bad_mental %>%
mutate(is_more = ifelse(children >= 5, "More than or equal", "Less than")) %>%
group_by(is_more) %>%
summarise(n = sum(num_resp)) %>%
mutate(prob = n / sum(n))
avg_bad_mental %>%
mutate(is_more = ifelse(children >= 6, "More than or equal", "Less than")) %>%
group_by(is_more) %>%
summarise(n = sum(num_resp)) %>%
mutate(prob = n / sum(n))
avg_bad_mental %>%
mutate(is_more = ifelse(children >= 6, "More than or equal", "Less than")) %>%
group_by(is_more) %>%
summarise(n = sum(num_resp)) %>%
mutate(proportion = n / sum(n))
avg_bad_mental %>%
mutate(is_more = ifelse(children >= 6, "More than or equal", "Less than")) %>%
group_by(is_more) %>%
summarise(n = sum(num_resp)) %>%
mutate(portion = n / sum(n))
avg_bad_mental <- avg_bad_mental %>%
filter(children < 6)
avg_bad_mental
ggplot(data=avg_bad_mental, aes(x=children, y=avg_bad_day, group=factor(income2), colour=income2)) +
geom_line()
income_age_edu <- brfss2013 %>%
select(income2, X_age_g, X_educag) %>%
filter(!is.na(income2), !is.na(X_age_g), !is.na(X_educag)) %>%
group_by(income2, X_age_g, X_educag) %>%
summarise(count = n())
income_age_edu %>%
str()
income_age_edu <- brfss2013 %>%
select(income2, X_age_g, X_educag) %>%
income_age_edu %>%
str()
income_age_edu <- brfss2013 %>%
select(income2, X_age_g, X_educag)
income_age_edu %>%
str()
fromVals <- c("Less than $10,000", "Less than $15,000", "Less than $20,000", "Less than $25,000", "Less than $35,000", "Less than $50,000", "Less than $75,000", "$75,000 or more")
toVals <- c(5000, 12500, 17500, 22500, 30000, 42500, 62500, 87500)
income_age_edu_disc <- income_age_edu %>%
mutate(income_disc = plyr::mapvalues(income2, fromVals, toVals))
income_age_edu_disc
income_age_edu_disc <- income_age_edu_disc %>%
filter(!is.na(income2), !is.na(X_age_g), !is.na(X_educag)) %>%
group_by(income2, X_age_g, X_educag) %>%
summarise(count = n())
age_edu_avgincome <- income_age_edu_disc %>%
mutate(total_income = as.numeric(as.character(income_disc)) * count) %>%
group_by(X_age_g, X_educag) %>%
summarise(avg_income = sum(total_income) / sum(count))
fromVals <- c("Less than $10,000", "Less than $15,000", "Less than $20,000", "Less than $25,000", "Less than $35,000", "Less than $50,000", "Less than $75,000", "$75,000 or more")
toVals <- c(5000, 12500, 17500, 22500, 30000, 42500, 62500, 87500)
income_age_edu_disc <- income_age_edu %>%
filter(!is.na(income2), !is.na(X_age_g), !is.na(X_educag)) %>%
group_by(income2, X_age_g, X_educag) %>%
summarise(count = n()) %>%
mutate(income_disc = plyr::mapvalues(income2, fromVals, toVals))
income_age_edu_disc
age_edu_avgincome <- income_age_edu_disc %>%
mutate(total_income = as.numeric(as.character(income_disc)) * count) %>%
group_by(X_age_g, X_educag) %>%
summarise(avg_income = sum(total_income) / sum(count))
age_edu_avgincome
ggplot(data=age_edu_avgincome, aes(x=X_age_g, y=avg_income, group=factor(X_educag), colour=X_educag)) +
geom_line() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
children_mental_income <- brfss2013 %>%
select(children, menthlth, income2)
children_mental_income %>%
str()
avg_bad_mental <- children_mental_income %>%
filter(!is.na(children), !is.na(income2), !is.na(menthlth)) %>%
group_by(children, income2) %>%
summarise(num_resp = n(), avg_bad_day = mean(menthlth))
avg_bad_mental
avg_bad_mental %>%
mutate(is_more = ifelse(children >= 6, "More than or equal", "Less than")) %>%
group_by(is_more) %>%
summarise(n = sum(num_resp)) %>%
mutate(portion = n / sum(n))
avg_bad_mental <- avg_bad_mental %>%
filter(children < 6)
avg_bad_mental
ggplot(data=avg_bad_mental, aes(x=children, y=avg_bad_day, group=factor(income2), colour=income2)) +
geom_line()
